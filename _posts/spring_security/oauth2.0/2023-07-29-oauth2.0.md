---
title: OAuth 2.0 에 대해서
date: 2023-07-29 18:10 +09:00
categories: ["Spring Security","OAuth2.0"]
tags: []
image:
    path: spring_security_logo.png
    alt: ""
---

# Introduction

> OAuth 2.0 의 주요 용어, 작동 흐름을 알아본다.
{: .prompt-info }

## OAuth 2.0 기초

> RFC 6749 <br/>
{: .prompt-info }

`OAuth 2.0` 는 `Authorization Protocol` 이다. `Authentication Protocol` 이 아니다. `Access Token` 을 사용해서 authorization 정보를 전달한다.

![oauth2_token](oauth2/oauth2_token.png)

> OAuth 2.0 를 사용하기위해서는 일단 사용되는 용어와 친해지는 것이 중요하다. <br/>
> 인가 서버로서 Keycloak 사용을 전제한다.
{: .prompt-warning }

### 용어

`Resource Owner`
- 보호된 자원에 대한 접근 권한을 부여할 수 있는 주체

`Client`
- 사용자를 ***대신***하여 권한을 부여받고, 사용자의 자원에 접근하는 어플리케이션
- 사용자를 `Authorization Server` 로 안내
- 사용자와의 상호 작용 없이도 권한 부여서버로 부터 직접 권한을 얻을 수 있다

`Resource Server`
- 타 어플리케이션에서 접근하는 사용자의 자원을 가지고 있는 서버
- Access Token 을 검증하고, 권한 체계에 따라서 접근 요청을 승인한다.

`Authorization Server`
- 클라이언트가 사용자 계정에 대한 동의, 접근을 요청할 때 상호 작용하는 서버
- 클라이언트의 권한 부여 요청을 승인 혹은 거부하는 서버

![concept](oauth2/oauth2_concept.png)


`Scopes`

`Access Token and Refresh Token`

`Grants And Flows`

실제 요청을 요구한 *사용자*를 대신해서 *클라이언트*가 *인가서버*로 부터 대리인 역할로 권한을 부여받는 것을 말한다. 

- `Authorization Code`
- access token 을 발급받기 위한 authorization code 를 획득
- `Implicit` ***(Deprecated)***
  - access token 을 바로 획득
  - 보안에 취약하다.
  - js 기반, 모바일 앱에서 사용
  - 인증정보가 담긴 스크립트가 노출된다.
- `Authorization with PKCE`
  - Authorization Code 방식에 Proof Key 를 적용해서 보안 강화
- `Resource Owner Credentials` ***(Deprecated)***
  - Authorization Server 로의 redirect 가 불가능 할때, Authorization Server 를 건너뛰고 Client 가 직접 권한을 획득
- `Client Credentials Grant`
- `Refresh Token Grant`
- `PKCE-enhanced Authorization Code Grant`





## 출처
1. [인프런 강의](https://inf.run/p7wr)
2. [https://auth0.com/intro-to-iam/what-is-oauth-2](https://auth0.com/intro-to-iam/what-is-oauth-2)
3. [https://goteleport.com/blog/how-oauth-authentication-works/](https://goteleport.com/blog/how-oauth-authentication-works/)
4. [https://www.ibm.com/docs/en/tfimbg/6.2.2.6?topic=overview-oauth-20-workflow](https://www.ibm.com/docs/en/tfimbg/6.2.2.6?topic=overview-oauth-20-workflow)
5. https://docs.vmware.com/en/Single-Sign-On-for-VMware-Tanzu-Application-service/1.11/Single-Sign-On-VMware-Tanzu-Application-service-1-11.pdf